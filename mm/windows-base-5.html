<!DOCTYPE html>

<!--(^･ｪ･^)--欢迎来到Hack萌妹-WWW.HackMM.COM--ฅ•ω•ฅ-->
<!--(^･ｪ･^)--Copyright©HackMM.COM--ฅ•ω•ฅ-->
<!--(^･ｪ･^)--Google和Firefox支持良好--ฅ•ω•ฅ-->
<!--░░░░░░░░░░▄-->
<!--░░░░░░░░▄▐░▄▄█████▄▄-->
<!--░░░░░░▄█████████████▄▀▄▄░▄▄▄-->
<!--░░░░░█████████████████▄██████-->
<!--░░░░████▐█████▌████████▌█████▌-->
<!--░░░████▌█████▌█░████████▐▀██▀-->
<!--░▄█████░█████▌░█░▀██████▌█▄▄▀▄-->
<!--░▌███▌█░▐███▌▌░░▄▄░▌█▌███▐███░▀-->
<!--▐░▐██░░▄▄▐▀█░░░▐▄█▀▌█▐███▐█-->
<!--  ░░███░▌▄█▌░░▀░░▀██░░▀██████▌-->
<!--░░░▀█▌▀██▀░▄░░░░░░░░░███▐███-->
<!--░░░░██▌░░░░░░░░░░░░░▐███████▌-->
<!--░░░░███░░░░░▀█▀░░░░░▐██▐███▀▌-->
<!--░░░░▌█▌█▄░░░░░░░░░▄▄████▀░▀-->
<!--░░░░░░█▀██▄▄▄░▄▄▀▀▒█▀█░▀-->
<!--░░░░░░░░░▀░▀█▀▌▒▒▒░▐▄▄-->
<!--░░░░░░░░▄▄▀▀▄░░░░░░▄▀░▀▀▄▄-->
<!--░░░░░░▄▀░▄▀▄░▌░░░▄▀░░░░░░▄▀▀▄-->
<!--░░░░░▐▒▄▀▄▀░▌▀▄▄▀░░░░░░▄▀▒▒▒▐-->
<!--░░░░▐▒▒▌▀▄░░░░░▌░░░░▄▄▀▒▐▒▒▒▒▌-->
<!--░░░▐▒▒▐░▌░▀▄░░▄▀▀▄▀▀▒▌▒▐▒▒▒▒▐▐-->
<!--░░░▌▄▀░░░▄▀░█▀▒▒▒▒▀▄▒▌▐▒▒▒▒▒▌▌-->
<!--░░▄▀▒▐░▄▀░░░▌▒▐▒▐▒▒▒▌▀▒▒▒▒▒▐▒▌-->
<!--__  __     ______     ______     __  __     __    __     __    __    -->
<!------░█░█░█▀█░█▀▀░█░█░█▄█░█▄█------>
<!------░█▀█░█▀█░█░░░█▀▄░█░█░█░█------>
<!------░▀░▀░▀░▀░▀▀▀░▀░▀░▀░▀░▀░▀------>

<html lang="zh-cn">
<!--head头包含js和css调用以及站点keywords等等-->
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0,minimum-scale=1.0, maximum-scale=1.0,user-scalable=no">
	<meta name="description" content="HackMM,我们的征途,是星辰大海.">
	<meta name="author" content="HackMM.COM-月刃">
	<meta name="keywords" content="hackmm,HackMM,月刃,hackmm.com,Hack萌妹,黑客萌妹,黑客技术,黑客学习,Windows技术,Linux技术,Archlinux,Linux软件,漏洞挖掘,网络安全,渗透测试,自动化办公,python全自动办公,Windows系统激活,新手学电脑,IT技术,Rust,Rust编程,黑客技术,黑客,红客,honker,hack,hacker">
	<title>[Win基础]-5-一次惊险的实战-Powershell和cmd基础 - HackMM.COM - 黑客萌妹</title>
	<link rel="shortcut icon" type="image/x-icon" href="../logo/favicon.png">
	<link rel="stylesheet" type="text/css" href="../css/basic.css">
	<link rel="stylesheet" type="text/css" href="../css/text.css">
	<!--prism.js代码高亮模块-->
	<link rel="stylesheet" href="../css/prism.css" data-noprefix />
	<script src="../plugins/prism.js"></script>
	<!--/prism.js代码高亮模块-->
	</script>
</head>
<!--/head结束-->
<body>
	<!--header -->
	<header id="nav">
			<div class="nav-container"> 
				<!--logo和描述-->
				<a href="https://www.hackmm.com" title="HackMM">
					<h1 class="nav-logo">Hack萌妹 - HackMM.COM</h1>
				</a>
				<h2 class="nav-site-description desc-hidden">
					我们的征途是星辰大海
				</h2>
				<!--/logo和描述-->
				<!-- nav导航-->
				<nav class="nav-links">
					<h1 style="display:none;">网站导航</h1> 
					<ul>
						<li class="active li-hidden">
							<a href="../index.html" title="home">
								<span class="link-word"><img src="../logo/home.png" alt="home" class="link-img"><span class="word-hidden">首页</span></span>
							</a>
						</li>
						<li>
							<a href="../sitemap.html" title="sitemap">
								<span class="link-word"><img src="../logo/archives.png" alt="archives" class="link-img"><span class="word-hidden">wiki</span></span>
							</a>
						</li>
					</ul>
				</nav>
				<!--/nav导航-->
			</div>		
	</header>
	<!-- /header -->

	<!-- content-->
	<div id="content">
		<div class="content-container">
			<!-- 文章区 -->
			<article class="text-container">
				<header class="text-header">
					<h1>[Win基础]-5-一次惊险的实战-Powershell和cmd基础</h1>	
				</header>
				<section class="text-body">
					<h2>引言</h2>
					<p>这篇文章的视频演示部分通过模拟后渗透测试，来演示Window中引进的Powershell与CMD在命令上的区别，大家可以根据实际情况，合理的使用能够使用的任何系统原生工具来完成我们的渗透，第三方工具借助的越少，就越不容易留下痕迹。</p>
					<!-- 目录 -->
					<h2>文章目录</h2>
					<ul class="contents">	
						 <li><a href="#windows-powershell-cmd-1">0×1.Powershell和cmd命令区别对比</a></li>
						 <li><a href="#windows-powershell-cmd-2">0×2.后渗透测试模拟实战视频演示</a></li>
					 </ul>
					<!-- /目录 -->

					<!-- 正文 -->
					<h2 id="windows-powershell-cmd-1">0×1.Powershell和cmd命令区别对比</h2>

					<p>首先，根据官方描述，PowerShell 是一种跨平台的任务自动化解决方案，由命令行 shell、脚本语言和配置管理框架组成。 PowerShell 在 Windows、Linux 和 macOS 上都能运行。</p>
					<p>也就是说，Powershell其实是一个可以装在各种操作系统上，独立于系统存在的一个Shell，并不像CMD那样是Windows的原生命令行工具，只是Win10后的系统都默认安装了这个Powershell。</p>

					<p>视频中用到的命令：</p>

					<pre class='line-numbers' data-prismjs-copy='复制代码' data-prismjs-copy-success='成功复制！' >
					<code class="lang-powershell">
					# 1.程序在执行过程中，程序文件无法删除，因为它执行在内存中，并且会创建一个进程
					查看进程的命令：
					//cmd下可以通过
					C:\Windows\System32&gt; tasklist /svc

					//powershell下可以通过 tasklist /svc或Get-Process
					//在cmd中切换到powershell只需要输入powershell回车即可切换，切换过去后，提示符前面会出现PS字样
					C:\Windows\System32&gt; powershell
					//获取内存进程名称包含regedit的进程信息
					PS C:\Windows\System32&gt; Get-Process -Name "regedit"
					//获取内存进程名称包含whoami的进程信息，支持通配符*，例如"whoami*"就能显示whoami开头的所有进程
					PS C:\Windows\System32&gt; Get-Process -Name "whoami"

					# 2.在登录windows server2022远程桌面时需要多人同时登录，可以通过修改注册表搞定

					//方法1：通过图形界面
					//开始-运行-输入regedit打开注册表
					//HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server
					//在右边找到  fSingleSessionPerUser  把值由1改为0

					//方法2：通过命令
					//cmd通过reg命令查询
					C:\Windows\System32&gt; reg query "hklm\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fSingleSessionPerUser
					//通过reg命令修改
					C:\Windows\System32&gt; reg add "hklm\SYSTEM\CurrentControlSet\Control\Terminal Server" /t REG_DWORD /v fSingleSessionPerUser /d 0

					//powershell通过reg命令，或者通过下面的命令查询
					//查询
					PS C:\Windows\System32&gt; Get-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server' -Name 'fSingleSessionPerUser'
					//修改
					PS C:\Windows\System32&gt; Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server' -Name 'fSingleSessionPerUser' -Value '0'

					# 3.关闭进程
					//CMD方法
					C:\Windows\System32&gt; taskkill /im PID /F
					
					//powershell方法
					//一次性关闭所有whoami开头的进程
					PS C:\Windows\System32&gt; ps -name whoami* | Stop-Process -force
					//精准匹配，只关闭whoami.exe，注意在PowerShell中，进程名称不需要携带.exe后缀，查询也是如此
					PS C:\Windows\System32&gt; ps -name whoami | Stop-Process -force
					</code>
					</pre>

					<p>在后面几篇文章中，会详细介绍到Powershell对进程的操作，这里稍作了解，知道Powershell和CMD的不同即可。</p>

					<h2 id="windows-powershell-cmd-2">0×2.后渗透测试模拟实战视频演示</h2>
	
					<p>点击下方视频标题，可以进入B站观看高清版本</p>
					<p>【第9天】Windows基础-9-一次惊险的实战操作？powershell和cmd的基础应用,开启多人win远程桌面~大一女新生挑战一年精通网络安全-信息安全-计算机安全-计算机技术-黑客技术-渗透测试，我无所畏惧</p>
					<iframe src="//player.bilibili.com/player.html?aid=833845928&bvid=BV1B34y1w76u&cid=1342001140&p=1&autoplay=0" allowfullscreen="allowfullscreen" width="100%" height="500" scrolling="no" frameborder="0" > </iframe>

					<p>第一篇文章中演示的虚拟机的下载可以通过我这个uc网盘去下载，里面包含了很多现成的系统镜像，还有虚拟机的激活码，也可以去官方下载，千万别去其他地方下精简版，很多问题都出在这里。网盘包含了最新的Windows+激活软件，流行的Linux镜像，会持续更新。</p>
					<p>*「虚拟机全套软件+ISO镜像文件」(会一直持续更新):<a title="虚拟机全套软件+ISO镜像文件" style="color: rgb(4,181,150);" href="https://drive.uc.cn/s/eb63654987fb4" target="_blank">点击打开</a> 密码：8s6H</p>
					<!-- /正文 -->

				<footer class="text-footer">
					<p>
						*转载请注明来自:<a title="HackMM.COM" style="color: rgb(4,181,150);" href="https://www.HackMM.com" target="_blank">HackMM.COM</a>
					</p>
					<p>*原文连接:<a title="[Win基础]-5-一次惊险的实战-Powershell和cmd基础" style="color: rgb(4,181,150);" href="https://www.HackMM.com/mm/windows-base-5.html" target="_blank">https://www.HackMM.com/mm/windows-base-5.html</a></p>
				</footer>
			</article>
			<!-- /文章区 -->	
		</div>
	</div>
	<!-- /content -->
	
	<!-- footer -->
	<footer id="footer">
		<div class="footer-container">
			HackMM.COM &nbsp;<img src="../logo/copyright.png" alt="未经作者允许,禁止任何形式的复制与转载" title="未经作者允许,禁止任何形式的复制与转载">&nbsp;All Rights Reserved.
		</div>
	</footer>
	<!-- /footer -->
</body>
</html>